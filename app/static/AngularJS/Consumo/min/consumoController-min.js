registrationModule.controller("consumoController",function(e,o,t,n,a){e.fechadesdeConsumo=new Date,e.fechahastaConsumo=new Date,getConsumosListaSuccess=function(e,t,n,s){o.consumoLista=e,a.success("Consumos Cargados"),$("#btnBuscarConsumo").button("reset")};var s=function(e,o,t,n){a.error("Ocurrio un problema")},u=function(){o.cliente=t.get("clienteActual"),e.cliente=o.cliente;var a=e.fechadesdeConsumo.format("yyyymmdd"),u=e.fechahastaConsumo.format("yyyymmdd");$("#btnBuscarConsumo").button("loading"),n.getConsumo(e.cliente.idContrato,a,u).success(getConsumosListaSuccess).error(s)},c=function(e,o,t,n){a.success("Reporte generado."),$("#btnConsumoExportar").button("reset"),window.open(global_settings.urlReportConsumos+e.replace(/"/g,""),"RptWindow","width=1024, height=768")};e.ReporteConsumos=function(){o.cliente=t.get("clienteActual"),e.cliente=o.cliente;var a=e.fechadesdeConsumo.format("yyyymmdd"),u=e.fechahastaConsumo.format("yyyymmdd");$("#btnConsumoExportar").button("loading"),n.getReporte(e.cliente.idContrato,a,u,e.cliente.idActa+" | "+e.cliente.razonSocial).success(c).error(s)},e.today=function(){e.dt1=new Date,e.dt2=new Date,o.fechaConsumo=new Date},e.today(),e.clear=function(){e.dt1=null,e.dt2=null,o.fechaConsumo=null},e.disabled=function(e,o){return"day"===o&&(-1===e.getDay()||7===e.getDay())},e.toggleMin=function(){e.minDate=e.minDate?null:(new Date).addYears(-1)},e.toggleMin(),e.open1=function(o){o.preventDefault(),o.stopPropagation(),e.opened1=!0},e.open2=function(o){o.preventDefault(),o.stopPropagation(),e.opened2=!0},o.openConsumo=function(e){e.preventDefault(),e.stopPropagation(),o.openedConsumo=!0},e.dateOptions={formatYear:"yy",startingDay:1},e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.fechadesdeConsumo=(new Date).addDays(-7),e.fechahastaConsumo=new Date,e.toggleSemana=function(o){o.preventDefault(),o.stopPropagation(),e.status.isopen=!e.status.isopen,e.labelDrop="Esta semana",e.fechadesdeConsumo=(new Date).addDays(-7),e.fechahastaConsumo=new Date,u()},e.toggleMes=function(o){o.preventDefault(),o.stopPropagation(),e.status.isopen=!e.status.isopen,e.labelDrop="Último mes",e.fechadesdeConsumo=(new Date).addMonths(-1),e.fechahastaConsumo=new Date,u()},e.toggleHoy=function(o){o.preventDefault(),o.stopPropagation(),e.status.isopen=!e.status.isopen,e.fechadesdeConsumo=new Date,e.fechahastaConsumo=new Date,e.labelDrop="El día de hoy",u()},e.labelDrop="Esta semana",e.Buscar=function(){e.fechadesdeConsumo=e.dt2,e.fechahastaConsumo=e.dt1,u()}});